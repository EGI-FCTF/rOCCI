<%# Mandatory settings %>
OCCI_ID       = <%= attributes["occi.core.id"]%>
NAME          = "<%= attributes["occi.core.title"]%>"
DESCRIPTION   = "<%= attributes['occi.core.summary'] if attributes['occi.core.summary']%>"
MEMORY        = <%= attributes["occi.compute.memory"].to_i * 1024 if attributes["occi.compute.memory"]%>
<% if attributes["occi.compute.architecture"] == "x64" %>
ARCHITECTURE  = x86_64
<% else %>
ARCHITECTURE  = i686
<% end %>
CPU           = <%= attributes["occi.compute.cores"] if attributes["occi.compute.cores"]%>
VCPU          = <%= attributes["opennebula.vm.vcpu"] if attributes["opennebula.vm.vcpu"]%>

<%# KVM specific settings %>
<% if attributes["opennebula.vm.boot"] %>
BOOT          = <%= attributes["opennebula.vm.boot"] if attributes["opennebula.vm.boot"]%>
<% else %>
BOOT          = hd
<% end %>

<%# Links to images %>
<% storages.each do |storage,link| %>
DISK          = [ IMAGE_ID = "<%= storage.backend[:id] %>"]
<%end%>

<%# Links to external storage %>
<% external_storages.each do |storage_URI| %>
DISK = [
  TYPE          = "OS",
  SOURCE        = <%= storage_URI %>
]
<%end%>
   
<%# Links to networks %>
<% networks.each do |network,link| %>
NIC           = [ 
  <% "IP         = " + link.attributes["occi.networkinferface.address"] + "," if link.attributes["occi.networkinferface.address"]%>
  <% "MAC        = " + link.attributes["occi.networkinferface.mac"] + "," if link.attributes["occi.networkinferface.mac"]%>
  NETWORK_ID = <%= network.backend[:id] %>
]
<%end%>

<%# Haizea Reservation parameters %>
HAIZEA=	[	start 		=	"<%= attributes["occi.reservation.start"] if attributes["occi.reservation.start"]%>",
			duration 	= 	"<%= attributes["occi.reservation.duration"] if attributes["occi.reservation.duration"]%>",
			preemptible	= 	"<%= attributes["occi.reservation.preemptible"] if attributes["occi.reservation.preemptible"]%>" ]

<%# Custom settings %>
GRAPHICS      = [ type="vnc" ]
RANK          = FREECPU
FEATURES      = [ acpi="yes" ]

<%# Contextualization settings %>
CONTEXT = [

]

